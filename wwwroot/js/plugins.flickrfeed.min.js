/*!
 * Original copyright:
 *
 * Copyright (C) 2009 Joel Sutherland
 * Licenced under the MIT license
 * http://www.newmediacampaigns.com/page/jquery-flickr-plugin
 *
 * Available tags for templates:
 * title, link, date_taken, description, published, author, author_id, tags, image*
 */
!function(e){e.fn.jflickrfeed=function(i,t){var a,n=(i=e.extend(!0,{flickrbase:"https://api.flickr.com/services/feeds/",feedapi:"photos_public.gne",limit:20,qstrings:{lang:"en-us",format:"json",jsoncallback:"?"},cleanDescription:!0,useTemplate:!0,itemTemplate:"",itemCallback:function(){}},i)).flickrbase+i.feedapi+"?",l=!0;for(a in i.qstrings)l||(n+="&"),n+=a+"="+i.qstrings[a],l=!1;return e(this).each((function(){var a=e(this),l=this;e.getJSON(n,(function(n){e.each(n.items,(function(e,t){var n,c,m,r;if(e<i.limit){if(i.cleanDescription&&(n=/<p>(.*?)<\/p>/g,c=t.description,n.test(c)&&(t.description=c.match(n)[2],void 0!==t.description&&(t.description=t.description.replace("<p>","").replace("</p>","")))),t.image_s=t.media.m.replace("_m","_s"),t.image_t=t.media.m.replace("_m","_t"),t.image_m=t.media.m.replace("_m","_m"),t.image=t.media.m.replace("_m",""),t.image_b=t.media.m.replace("_m","_b"),t.image_q=t.media.m.replace("_m","_q"),delete t.media,i.useTemplate){for(m in r=i.itemTemplate,t)n=new RegExp("{{"+m+"}}","g"),r=r.replace(n,t[m]);a.append(r)}i.itemCallback.call(l,t)}})),e.isFunction(t)&&t.call(l,n)}))}))}}(jQuery),window.SEMICOLON_flickrFeedInit=function(e){if((e=e.filter(":not(.customjs)")).length<1)return!0;e.each((function(){let e=$(this),i=e.attr("data-id"),t=e.attr("data-count")||9,a="photos_public.gne";"group"==e.attr("data-type")&&(a="groups_pool.gne"),e.jflickrfeed({feedapi:a,limit:Number(t),qstrings:{id:i},itemTemplate:'<a class="grid-item" href="{{image_b}}" title="{{title}}" data-lightbox="gallery-item"><img src="{{image_s}}" alt="{{title}}" /></a>'},(function(i){SEMICOLON.initialize.lightbox({parent:e})}))}))};